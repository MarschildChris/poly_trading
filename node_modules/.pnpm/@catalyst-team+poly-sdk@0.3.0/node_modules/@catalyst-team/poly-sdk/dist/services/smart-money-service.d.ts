/**
 * SmartMoneyService
 *
 * 聪明钱监控和自动跟单服务
 *
 * 核心功能：
 * 1. 监听指定地址的交易 - subscribeSmartMoneyTrades()
 * 2. 自动跟单 - startAutoCopyTrading()
 * 3. 聪明钱信息获取 - getSmartMoneyList(), getSmartMoneyInfo()
 *
 * ============================================================================
 * 设计决策
 * ============================================================================
 *
 * ## 监控方式
 * 使用 Activity WebSocket，延迟 < 100ms，实测验证有效。
 *
 * ## 下单方式
 * | 方式 | 使用场景 | 特点 |
 * |------|---------|------|
 * | FOK | 小额跟单 | 全部成交或取消 |
 * | FAK | 大额跟单 | 部分成交也接受 |
 *
 * ## 重要限制
 * ⚠️ Activity WebSocket 不会广播用户自己的交易！
 * 验证跟单结果请使用 TradingService.getTrades()
 */
import type { WalletService } from './wallet-service.js';
import type { RealtimeServiceV2 } from './realtime-service-v2.js';
import type { TradingService, OrderResult } from './trading-service.js';
/**
 * Smart Money wallet information
 */
export interface SmartMoneyWallet {
    address: string;
    name?: string;
    pnl: number;
    volume: number;
    score: number;
    rank?: number;
}
/**
 * Smart Money trade from Activity WebSocket
 */
export interface SmartMoneyTrade {
    traderAddress: string;
    traderName?: string;
    conditionId?: string;
    marketSlug?: string;
    side: 'BUY' | 'SELL';
    size: number;
    price: number;
    tokenId?: string;
    outcome?: string;
    txHash?: string;
    timestamp: number;
    isSmartMoney: boolean;
    smartMoneyInfo?: SmartMoneyWallet;
}
/**
 * Auto copy trading options
 */
export interface AutoCopyTradingOptions {
    /** Specific wallet addresses to follow */
    targetAddresses?: string[];
    /** Follow top N from leaderboard */
    topN?: number;
    /** Scale factor for size (0.1 = 10%) */
    sizeScale?: number;
    /** Maximum USDC per trade */
    maxSizePerTrade?: number;
    /** Maximum slippage (e.g., 0.03 = 3%) */
    maxSlippage?: number;
    /** Order type: FOK or FAK */
    orderType?: 'FOK' | 'FAK';
    /** Delay before executing (ms) */
    delay?: number;
    /** Minimum trade value to copy (USDC) */
    minTradeSize?: number;
    /** Only copy BUY or SELL trades */
    sideFilter?: 'BUY' | 'SELL';
    /** Dry run mode */
    dryRun?: boolean;
    /** Callbacks */
    onTrade?: (trade: SmartMoneyTrade, result: OrderResult) => void;
    onError?: (error: Error) => void;
}
/**
 * Auto copy trading statistics
 */
export interface AutoCopyTradingStats {
    startTime: number;
    tradesDetected: number;
    tradesExecuted: number;
    tradesSkipped: number;
    tradesFailed: number;
    totalUsdcSpent: number;
}
/**
 * Auto copy trading subscription
 */
export interface AutoCopyTradingSubscription {
    id: string;
    targetAddresses: string[];
    startTime: number;
    isActive: boolean;
    stats: AutoCopyTradingStats;
    stop: () => void;
    getStats: () => AutoCopyTradingStats;
}
/**
 * Service configuration
 */
export interface SmartMoneyServiceConfig {
    /** Minimum PnL to be considered Smart Money (default: $1000) */
    minPnl?: number;
    /** Cache TTL (default: 300000 = 5 min) */
    cacheTtl?: number;
}
export declare class SmartMoneyService {
    private walletService;
    private realtimeService;
    private tradingService;
    private config;
    private smartMoneyCache;
    private smartMoneySet;
    private cacheTimestamp;
    private activeSubscription;
    private tradeHandlers;
    constructor(walletService: WalletService, realtimeService: RealtimeServiceV2, tradingService: TradingService, config?: SmartMoneyServiceConfig);
    /**
     * Get list of Smart Money wallets from leaderboard
     */
    getSmartMoneyList(limit?: number): Promise<SmartMoneyWallet[]>;
    /**
     * Check if an address is Smart Money
     */
    isSmartMoney(address: string): Promise<boolean>;
    /**
     * Get Smart Money info for an address
     */
    getSmartMoneyInfo(address: string): Promise<SmartMoneyWallet | null>;
    /**
     * Subscribe to trades from specific addresses
     *
     * @example
     * ```typescript
     * const sub = smartMoneyService.subscribeSmartMoneyTrades(
     *   (trade) => {
     *     console.log(`${trade.traderName} ${trade.side} ${trade.size} @ ${trade.price}`);
     *   },
     *   { filterAddresses: ['0x1234...', '0x5678...'] }
     * );
     *
     * // Stop listening
     * sub.unsubscribe();
     * ```
     */
    subscribeSmartMoneyTrades(onTrade: (trade: SmartMoneyTrade) => void, options?: {
        filterAddresses?: string[];
        minSize?: number;
        smartMoneyOnly?: boolean;
    }): {
        id: string;
        unsubscribe: () => void;
    };
    private handleActivityTrade;
    /**
     * Start auto copy trading - 自动跟单
     *
     * @example
     * ```typescript
     * const sub = await smartMoneyService.startAutoCopyTrading({
     *   targetAddresses: ['0x1234...'],
     *   // 或者跟踪排行榜前N名
     *   topN: 10,
     *
     *   sizeScale: 0.1,        // 10%
     *   maxSizePerTrade: 50,   // $50
     *   maxSlippage: 0.03,     // 3%
     *   orderType: 'FOK',
     *
     *   dryRun: true,          // 测试模式
     *
     *   onTrade: (trade, result) => console.log(result),
     * });
     *
     * // 停止
     * sub.stop();
     * ```
     */
    startAutoCopyTrading(options: AutoCopyTradingOptions): Promise<AutoCopyTradingSubscription>;
    private isCacheValid;
    disconnect(): void;
}
//# sourceMappingURL=smart-money-service.d.ts.map