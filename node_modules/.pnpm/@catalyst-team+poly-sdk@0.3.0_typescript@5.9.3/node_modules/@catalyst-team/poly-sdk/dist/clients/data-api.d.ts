/**
 * Data API Client for Polymarket
 * Handles: positions, activity, trades, leaderboard
 */
import { RateLimiter } from '../core/rate-limiter.js';
import type { UnifiedCache } from '../core/unified-cache.js';
export interface Position {
    proxyWallet?: string;
    asset: string;
    conditionId: string;
    outcome: string;
    outcomeIndex: number;
    size: number;
    avgPrice: number;
    curPrice?: number;
    totalBought?: number;
    initialValue?: number;
    currentValue?: number;
    cashPnl?: number;
    percentPnl?: number;
    realizedPnl?: number;
    percentRealizedPnl?: number;
    title: string;
    slug?: string;
    icon?: string;
    eventId?: string;
    eventSlug?: string;
    oppositeOutcome?: string;
    oppositeAsset?: string;
    redeemable?: boolean;
    mergeable?: boolean;
    endDate?: string;
    negativeRisk?: boolean;
}
export interface Activity {
    type: 'TRADE' | 'SPLIT' | 'MERGE' | 'REDEEM' | 'CONVERSION';
    side: 'BUY' | 'SELL';
    size: number;
    price: number;
    usdcSize?: number;
    asset: string;
    conditionId: string;
    outcome: string;
    outcomeIndex?: number;
    timestamp: number;
    transactionHash: string;
    title?: string;
    slug?: string;
    name?: string;
}
export interface Trade {
    id?: string;
    market: string;
    asset: string;
    side: 'BUY' | 'SELL';
    price: number;
    size: number;
    outcome: string;
    outcomeIndex: number;
    timestamp: number;
    transactionHash: string;
    proxyWallet?: string;
    title?: string;
    slug?: string;
    icon?: string;
    eventSlug?: string;
    name?: string;
    pseudonym?: string;
    bio?: string;
    profileImage?: string;
    profileImageOptimized?: string;
}
export interface LeaderboardEntry {
    address: string;
    rank: number;
    pnl: number;
    volume: number;
    userName?: string;
    xUsername?: string;
    verifiedBadge?: boolean;
    profileImage?: string;
    positions?: number;
    trades?: number;
}
export interface LeaderboardPage {
    entries: LeaderboardEntry[];
    total: number;
    offset: number;
    limit: number;
}
/**
 * Time period for leaderboard filtering
 */
export type LeaderboardTimePeriod = 'DAY' | 'WEEK' | 'MONTH' | 'ALL';
/**
 * Ordering criteria for leaderboard
 */
export type LeaderboardOrderBy = 'PNL' | 'VOL';
/**
 * Market category for leaderboard filtering
 */
export type LeaderboardCategory = 'OVERALL' | 'POLITICS' | 'SPORTS' | 'CRYPTO' | 'CULTURE' | 'MENTIONS' | 'WEATHER' | 'ECONOMICS' | 'TECH' | 'FINANCE';
/**
 * Leaderboard query parameters
 * @see https://docs.polymarket.com/api-reference/core/get-trader-leaderboard-rankings
 */
export interface LeaderboardParams {
    /** Time period for leaderboard results (default: DAY) */
    timePeriod?: LeaderboardTimePeriod;
    /** Ordering criteria (default: PNL) */
    orderBy?: LeaderboardOrderBy;
    /** Market category filter (default: OVERALL) */
    category?: LeaderboardCategory;
    /** Max number of traders to return (1-50, default: 25) */
    limit?: number;
    /** Starting index for pagination (0-1000, default: 0) */
    offset?: number;
    /** Filter by specific user address */
    user?: string;
    /** Filter by username */
    userName?: string;
}
/**
 * Activity query parameters
 * @see https://docs.polymarket.com/developers/misc-endpoints/data-api-activity
 */
export interface ActivityParams {
    /** Maximum number of results (0-500, default: 100) */
    limit?: number;
    /** Pagination offset (0-10000) */
    offset?: number;
    /** Start timestamp (Unix seconds) - filter activities after this time */
    start?: number;
    /** End timestamp (Unix seconds) - filter activities before this time */
    end?: number;
    /** Activity type filter */
    type?: 'TRADE' | 'SPLIT' | 'MERGE' | 'REDEEM' | 'REWARD' | 'CONVERSION';
    /** Trade side filter */
    side?: 'BUY' | 'SELL';
    /** Market condition IDs to filter */
    market?: string[];
    /** Event IDs to filter */
    eventId?: number[];
    /** Sort field */
    sortBy?: 'TIMESTAMP' | 'TOKENS' | 'CASH';
    /** Sort direction */
    sortDirection?: 'ASC' | 'DESC';
}
/**
 * Positions query parameters
 * @see https://docs.polymarket.com/developers/misc-endpoints/data-api-get-positions
 */
export interface PositionsParams {
    /** Maximum number of results (0-500, default: 100) */
    limit?: number;
    /** Pagination offset (0-10000) */
    offset?: number;
    /** Market condition IDs to filter */
    market?: string[];
    /** Event IDs to filter */
    eventId?: number[];
    /** Minimum position size to include (default: 1) */
    sizeThreshold?: number;
    /** Only return redeemable positions */
    redeemable?: boolean;
    /** Only return mergeable positions */
    mergeable?: boolean;
    /** Search by title */
    title?: string;
    /** Sort field */
    sortBy?: 'CURRENT' | 'INITIAL' | 'TOKENS' | 'CASHPNL' | 'PERCENTPNL' | 'TITLE' | 'RESOLVING' | 'PRICE' | 'AVGPRICE';
    /** Sort direction */
    sortDirection?: 'ASC' | 'DESC';
}
/**
 * Trades query parameters
 */
export interface TradesParams {
    /** Maximum number of results (default: 500) */
    limit?: number;
    /** Market condition ID to filter */
    market?: string;
    /** User wallet address to filter */
    user?: string;
    /** Only return taker trades */
    takerOnly?: boolean;
    /** Filter by cash or token amount */
    filterType?: 'CASH' | 'TOKENS';
    /** Minimum amount threshold */
    filterAmount?: number;
    /** Trade side filter */
    side?: 'BUY' | 'SELL';
}
/**
 * Closed positions query parameters
 * @see https://docs.polymarket.com/api-reference/core/get-closed-positions-for-a-user
 */
export interface ClosedPositionsParams {
    /** Maximum number of results (0-50, default: 10) */
    limit?: number;
    /** Pagination offset (0-100000) */
    offset?: number;
    /** Market condition IDs to filter */
    market?: string[];
    /** Event IDs to filter */
    eventId?: number[];
    /** Search by title (max 100 chars) */
    title?: string;
    /** Sort field */
    sortBy?: 'REALIZEDPNL' | 'TITLE' | 'PRICE' | 'AVGPRICE' | 'TIMESTAMP';
    /** Sort direction */
    sortDirection?: 'ASC' | 'DESC';
}
/**
 * Closed position entry
 */
export interface ClosedPosition {
    proxyWallet: string;
    asset: string;
    conditionId: string;
    avgPrice: number;
    totalBought: number;
    realizedPnl: number;
    curPrice: number;
    timestamp: number;
    title: string;
    slug?: string;
    icon?: string;
    eventSlug?: string;
    outcome: string;
    outcomeIndex: number;
    oppositeOutcome?: string;
    oppositeAsset?: string;
    endDate?: string;
}
/**
 * Holders query parameters
 */
export interface HoldersParams {
    /** Market condition ID (required) */
    market: string;
    /** Maximum number of results */
    limit?: number;
}
/**
 * Account value response
 */
export interface AccountValue {
    user: string;
    value: number;
}
/**
 * Market holder entry
 */
export interface MarketHolder {
    proxyWallet: string;
    size: number;
    outcome: string;
    value?: number;
    userName?: string;
    profileImage?: string;
}
export declare class DataApiClient {
    private rateLimiter;
    private cache;
    constructor(rateLimiter: RateLimiter, cache: UnifiedCache);
    /**
     * Get positions for a wallet address
     *
     * @param address - Wallet address
     * @param params - Query parameters (P0/P1: limit, offset, sortBy, sortDirection, market, etc.)
     *
     * @example
     * ```typescript
     * // Get all positions
     * const positions = await client.getPositions(address);
     *
     * // Get positions sorted by PnL (highest first)
     * const topPnl = await client.getPositions(address, {
     *   sortBy: 'CASHPNL',
     *   sortDirection: 'DESC',
     *   limit: 10,
     * });
     *
     * // Get only redeemable positions
     * const redeemable = await client.getPositions(address, { redeemable: true });
     * ```
     */
    getPositions(address: string, params?: PositionsParams): Promise<Position[]>;
    /**
     * Get closed positions for a wallet address
     *
     * @param address - Wallet address
     * @param params - Query parameters
     *
     * @example
     * ```typescript
     * // Get closed positions sorted by realized PnL
     * const closed = await client.getClosedPositions(address);
     *
     * // Get recent settlements
     * const recent = await client.getClosedPositions(address, {
     *   sortBy: 'TIMESTAMP',
     *   sortDirection: 'DESC',
     *   limit: 20,
     * });
     * ```
     */
    getClosedPositions(address: string, params?: ClosedPositionsParams): Promise<ClosedPosition[]>;
    /**
     * Get activity for a wallet address
     *
     * @param address - Wallet address
     * @param params - Query parameters (P0: start, end, offset; P1: market, sortBy, etc.)
     *
     * @example
     * ```typescript
     * // Get recent activity
     * const activity = await client.getActivity(address, { limit: 50 });
     *
     * // Get activity in a time range (Unix seconds)
     * const dayAgo = Math.floor(Date.now() / 1000) - 86400;
     * const recent = await client.getActivity(address, {
     *   start: dayAgo,
     *   limit: 100,
     * });
     *
     * // Paginate through all activity
     * const page2 = await client.getActivity(address, { offset: 100, limit: 100 });
     * ```
     */
    getActivity(address: string, params?: ActivityParams): Promise<Activity[]>;
    /**
     * Get all activity for a wallet (auto-pagination)
     *
     * @param address - Wallet address
     * @param params - Query parameters
     * @param maxItems - Maximum items to fetch (default: 10000)
     *
     * @example
     * ```typescript
     * // Get all activity since a specific date
     * const startDate = Math.floor(new Date('2024-12-01').getTime() / 1000);
     * const allActivity = await client.getAllActivity(address, { start: startDate });
     * ```
     */
    getAllActivity(address: string, params?: Omit<ActivityParams, 'offset' | 'limit'>, maxItems?: number): Promise<Activity[]>;
    /**
     * Get recent trades
     *
     * @param params - Query parameters (P2: user, side, takerOnly, etc.)
     *
     * @example
     * ```typescript
     * // Get market trades
     * const trades = await client.getTrades({ market: conditionId, limit: 100 });
     *
     * // Get user trades (P2)
     * const userTrades = await client.getTrades({ user: address, limit: 50 });
     *
     * // Get only buy trades
     * const buys = await client.getTrades({ market: conditionId, side: 'BUY' });
     * ```
     */
    getTrades(params?: TradesParams): Promise<Trade[]>;
    /**
     * Get trades for a specific market
     */
    getTradesByMarket(conditionId: string, limit?: number): Promise<Trade[]>;
    /**
     * Get trades for a specific user (P2)
     */
    getTradesByUser(address: string, params?: Omit<TradesParams, 'user'>): Promise<Trade[]>;
    /**
     * Get leaderboard page with time period and ordering support
     *
     * @param params - Query parameters
     * @param params.timePeriod - Time period: 'DAY', 'WEEK', 'MONTH', 'ALL' (default: 'ALL' for backward compatibility)
     * @param params.orderBy - Order by: 'PNL', 'VOL' (default: 'PNL')
     * @param params.category - Category filter (default: 'OVERALL')
     * @param params.limit - Max entries per page (1-50, default: 50)
     * @param params.offset - Pagination offset (0-1000, default: 0)
     *
     * @example
     * ```typescript
     * // Get today's top traders by PnL
     * const daily = await client.getLeaderboard({ timePeriod: 'DAY', orderBy: 'PNL' });
     *
     * // Get this week's top traders by volume
     * const weekly = await client.getLeaderboard({ timePeriod: 'WEEK', orderBy: 'VOL' });
     *
     * // Get politics category leaderboard
     * const politics = await client.getLeaderboard({ category: 'POLITICS' });
     * ```
     */
    getLeaderboard(params?: LeaderboardParams): Promise<LeaderboardPage>;
    /**
     * Get all leaderboard entries up to a max count
     */
    getAllLeaderboard(maxEntries?: number): Promise<LeaderboardEntry[]>;
    /**
     * Get account total value (P1)
     *
     * @param address - Wallet address
     * @param markets - Optional: filter by specific markets
     *
     * @example
     * ```typescript
     * const { value } = await client.getAccountValue(address);
     * console.log(`Total account value: $${value.toFixed(2)}`);
     * ```
     */
    getAccountValue(address: string, markets?: string[]): Promise<AccountValue>;
    /**
     * Get market holders (P2)
     *
     * Returns top holders for a specific market. Note: This endpoint can timeout
     * for large markets.
     *
     * @param params - Query parameters (market is required)
     *
     * @example
     * ```typescript
     * const holders = await client.getMarketHolders({
     *   market: conditionId,
     *   limit: 20,
     * });
     * ```
     */
    getMarketHolders(params: HoldersParams): Promise<MarketHolder[]>;
    private normalizePositions;
    private normalizeClosedPositions;
    private normalizeActivities;
    private normalizeTrades;
    private normalizeTimestamp;
    private normalizeLeaderboardEntries;
    private normalizeHolders;
}
//# sourceMappingURL=data-api.d.ts.map